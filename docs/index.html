<script src="./az.min.js"></script>
<script src="./RTT/index.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@json-editor/json-editor@latest/dist/jsoneditor.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>

<div class="container">
    <div class="row">
        <div class="col">
            <div class="accordion" id="accordionExample">
                <div class="accordion-item">
                  <h2 class="accordion-header" id="headingOne">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                      Демка
                    </button>
                  </h2>
                  <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                      <textarea id='inputText'>привет! в какое время вы работаете?</textarea>
                      <button id="GoRTTButton" disabled>Посмотреть</button>
                      <div id="markers"></div>
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <h2 class="accordion-header" id="headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                      JSON триггеров
                    </button>
                  </h2>
                  <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                        <div id="jsonEditorHolder"></div>
                    </div>
                  </div>
                </div>
              </div>
        </div>
    </div>
</div>




<script>
    let triggers = [
        {
            name: "Приветсвие",
            words: [{text: ["привет", "хелоу", "здарова", "хай", "прив"]}],
            markers: [1],
            check_scope: 'sentences'
        },
        {
            name: "Вопрос о времени работы",
            words: [
                {normalized: ["какой"]},
                {normalized: ["время", "час", "часы"]},
                {normalized: ["работать"]},
            ],
            markers: [2],
            check_scope: 'sentences'
        },
    ];
</script>



<script>
    let RTT;
    window.onload = function() {
        const element = document.getElementById('jsonEditorHolder');
        const editor = new JSONEditor(element, {
            schema: {},
            theme: 'bootstrap4'
        });
        editor.setValue(triggers);
        console.log("Window Loaded")
    };

    Az.Morph.init('./dicts', function(){
        console.log('AZ Loaded')
        RTT = RussianTextTagger({triggers, loadedAz: Az, uniq_markers: true});
        GoRTTButton.disabled = false;
        GoRTT()
    })

    GoRTTButton.onclick = GoRTT;

    function GoRTT(){
        let result = RTT(inputText.value);
        console.log("RTT Result:", result);
        markers.innerHTML = "";
        for(let marker of result.markers){
            markers.innerText += marker+",";
        }
    }

    
</script>